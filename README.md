# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание состояний страницы
Каталог - "главная страница" проекта, отрисовывается сразу и без условий. Выведены все имеющиеся в наличии товары. Для каждого товара указано: название, категория, изображение, стоимость.
Установлены слушатели событий на всех карточках товара (при нажатии открывается попап) и на кнопке корзины (при нажатии открывается попап корзины)

Открытая карта товара - открывается в виде попапа при нажатии на конкретный товар. Содержит данные: название, описание, категория, изображение, стоимость и кнопку "купить".

Корзина - открывается в виде попапа в двух случаях - нажатие на иконку корзины или нажатие на кнопку коризину внутри попапа "открытая карта товара". Содержит нумерованный список товаров с названием и ценой, подсчётом общей стоимости. Позволяет удалять отдельные товары из корзины и перейти к модальному окну "данные для оплаты"

Данные для оплаты - два последовательный модальных окна, где попарно размещены формы для заполнения. Только полностью заполненная форма позволяет перейти к следующей форме. После заполнения обеих форм открывается попап "успешно"

Заказ оформлен - открывается только при корректном заполнении обеих форм данных оплаты, отображает необходимую информацию и последнее состояние суммы в корзине. Закрывается при нажатии на кнопку "за новыми покупками" (кроме обычных закрытий для всех модальных окон при нажатии на оверлей и на кнопку закрытия)

## Представление о работе кода
Приложение реализовано в архитектуре MVP, где есть отдельные классы, отвечающие за получение и обработку данных (Api, Product, Basket, GetDataFromApi), классы, отвечающие за отображение информации (Modal, ModalOrder, ModalBasket, Catalog, ModalSuccess) и класс, отвечающий за управление событиями (EventEmitter)

## Базовые классы
### Класс "EventEmitter"
Установка и снятие слушателей с элементов, организация взаимодействия классов модельного типа и отображающего. На каждое событие в приложении создаётся свой слушатель, который или меняет отображение, или меняет данные.

### Класс "Modal"
Базовый класс, который знает только основные типы поведения модального окна - то что оно должно открываться и закрываться. Является родителем для более конкретных классов.

**Поля**:
closeButton - кнопка закрытия. Тип HTMLButtonElement
modalSelector - уникальный селектор модального окна, по которому ищется его кнопка закрытия. Тип string

**Методы**:
openModal() - открывает модальное окно товара или корзины на главной странице
closeModal() - отвечает за закрытие модального окна при нажатии на кнопку закрытия и нажатии на оверлей
openNext() - в каждом модальном окне данного приложения есть кнопка, этот метод задаёт поведение при её нажатии. Базово это закрытие нынешнего модального окна и открытие следующего по цепочке логики.


## Описание дополнительных классов

### Класс "GetDataFromApi"
Наследует класс Api, отвечает за получение данных с сервера, необходимых нам. 
**Реализует метод**
getData() - отправляет запрос на сервер и получает массив объектов (данных о товаре)

### Класс "Product"
Содержит в себе все данные о продукте, может их менять и использовать.
**Поля**:
id - уникальное значение для каждого товара. Тип string
name - название товара. Тип string.
icon - иконку-изображение товара. Тип string.
category - принадлежность к категории товаров. Тип string.
cost - стоимость. Тип costType.
displayedСost - отображаемая стоимость. Тип string. На странице товары должны отображаться с указанием единицы оплаты, поэтому требуется дополнительное поле. В конструкторе будет рассчитываться по условию: если равно 0, значение "бесценно", если значение больше нуля, то значение + " синапсов". (В макете нет стоимости менее 5 синапсов, иначе можно было бы ввести третью проверку, от 1 до 4 значение было бы: значение + " синапса").
description - описание товара. Тип string.
inBasket - поскольку мы можем добавить товар в корзину лишь один раз, введем эту проверку для самого товара. Тип boolean

В **конструктор** при создании передаются данные от api, + inBasket при инициализации у каждого товара по умолчанию false

**Методы**: 
getData() - возвращает данные, необходимые для отрисовки в каталоге или открытой карты товара (название, изображение, цена, категория)

### Класс "Basket"
Хранит в себе данные для отрисовки их в корзине, нужные данные получает от экземпляров класса Product, которые вносят в корзину.

**Поля**
productsInBasket - по умолчанию при инициализации значение = [], при добавлении товаров - множество объектов типа (name - Product.name, значение Product.dispayedCost)
sumInBasket - по умолчанию при инициализации значение = 0, при добавлении товара добавляется (сложением) стоимость нового товара. Тип number
displayedSumInBasket - отображаемая стоимость. Тип string. В корзине общая стоимость должна отображаться с указанием единицы оплаты, поэтому требуется дополнительное поле.

**Методы**:
setToBasket() - принимает название и цену товара, добавляет их в множество объектов inBasket, добавляет стоимость товара в sumInBasket, обновляет состояние поля displayedSumInBasket (если равно 0, значение "корзина пуста, положите что-нибудь сюда", если значение больше нуля, то значение + " синапсов". ) 
deleteFromBasket() - по нажатию кнопки удаления около товара - удаляет его, обновляет поля sumInBasket и displayedSumInBasket
cleanBasket() - очищает корзину

### Класс "Catalog"
Отвечает за отображение всех карточек на главной странице. Принимает экземляры всех объектов класса Product и отображает их на странице

**Основные методы**
createProdactCard() - создаёт одну карточку
renderCatalog() - используя все экземпляры класса Prodact, отображает их на странице

### Класс "ModalCardFull"
Этот класс необходим для отображения попапа подробной карточки товара, принимает значение из объекта типа Product, на который был произведен клик (в момент клика создается конкретный экземпляр данного класса, относящийся к карточке товара, на который кликнули).

**Наследуется** от класса "Modal"
Переопределяет поле "modalSelector" как "card_full"

В **конструктор** приходит экземпляр класса Product, который переносит в этот класс значение своих полей соотвественно

**Основные методы** (кроме тех, что наследуются)
renderModalCardFull() - отвечает за отрисовку данных в модальном окне. При отрисовке проверка - если товар есть в корзине, для кнопки устанавливается неактивное состояние

### Класс "ModalOrder"
Отвечает за отрисовку последовательных попапов, которые появляются при оформлении заказа. Этот класс будет иметь всего 2 экземпляра - один будет реализовывать форму "способ оплаты" и "адрес доставки", второй - "e-mail" и "телефон" соответственно

Наследуется от класса Modal
Переопределяет поле "modalSelector" как "order"

**Конструктор** принимает пары значений (название поля, тип поля) и сохраняет их в поля класса

**Основные методы**
renderModalOrder() - отвечает за отрисовку попапа, его полей и кнопки
closeModal() - кроме родительских функций приобретает закрытие при нажатии на кнопку "закрытие" и вызывает открытие модального окна "корзина"
openNext() - дополняет родительский метод: при успешной валидации форм открывает следующую страницу при нажатии на кнопку. Вызывает открытие следующего попапа (или следующего экземпляра класса, или сообщения об успешном оформлении заказа)

### Класс "ModalBasket"
Отвечает за визуальное отображение модального окна корзины, принимает данные из класса Basket.
Наследуется от класса Modal
Переопределяет поле "modalSelector" как "basket"

**Имеет дополнительно поля**:
modalName - статичное поле, значение "Корзина"

**Основные методы**
renderBasket() - отвечает за отрисовку данных в модальном окне. Данные товаров отрисовывает в виде нумерованного списка присваивая им номера начиная с "1", размещает имя, цену и кнопку удаления товара. Отрисовавывает displayedSumInBasket

### Класс "ModalSuccess"
Класс отвечает за отрисовку данных в модальном окне успешного оформления заказа. Получает необходимые данные из поля displayedSumInBasket класса Basket.

Наследуется от класса Modal
Переопределяет поле "modalSelector" как "order-success"

**Поля**:
successIcon: тип string.
lastBuscetSum: тип string. В конструкторе превращает переданную последнюю сумму в корзины в строку "Списано ${сумма} синапсов"

**Основные методы**
renderSuccess() - открывает модальное окно, показывающее сообщение об успешном оформлении заказа, вносит данные в модальное окно для отрисовки. Вызывет cleanBasket() для корзины
openNext() - переопределяет родительский метод, при нажатии на кнопку окно просто закрывается
