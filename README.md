# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание состояний страницы
Каталог - "главная страница" проекта, отрисовывается сразу и без условий. Выведены все имеющиеся в наличии товары. Для каждого товара указано: название, категория, изображение, стоимость.
Установлены слушатели событий на всех карточках товара (при нажатии открывается попап) и на кнопке корзины (при нажатии открывается попап корзины)

Открытая карта товара - открывается в виде попапа при нажатии на конкретный товар. Содержит данные: название, описание, категория, изображение, стоимость и кнопку "купить".

Корзина - открывается в виде попапа при нажатии на иконку корзины. Содержит нумерованный список товаров с названием и ценой, подсчётом общей стоимости. Позволяет удалять отдельные товары из корзины и перейти к модальному окну "данные для оплаты"

Данные для оплаты - два последовательный модальных окна, где попарно размещены формы для заполнения. Только полностью заполненная форма позволяет перейти к следующей форме. После заполнения обеих форм открывается попап "успешно"

Заказ оформлен - открывается только при корректном заполнении обеих форм данных оплаты, отображает необходимую информацию и последнее состояние суммы в корзине. Закрывается при нажатии на кнопку "за новыми покупками" (кроме обычных закрытий для всех модальных окон при нажатии на оверлей и на кнопку закрытия), при закрытии этого окна очищаются данные внутри корзины

## Представление о работе кода
Приложение реализовано в архитектуре MVP, где есть отдельные классы, отвечающие за получение и обработку данных (Api, Product, Basket, ProdactApi), классы, отвечающие за отображение информации (Modal, ModalOrder, ModalBasket, Catalog, ModalSuccess) и класс, отвечающий за управление событиями (EventEmitter)

## Базовые классы
### Класс "EventEmitter"
Установка и снятие слушателей с элементов, организация взаимодействия классов модельного типа и отображающего. На каждое событие в приложении создаётся свой слушатель, который или меняет отображение, или меняет данные.

### Класс "Modal"
Базовый класс, который знает только основные типы поведения модального окна - то что оно должно открываться и закрываться. Является родителем для более конкретных классов.

**Методы**:
openModal() - открывает модальное окно товара или корзины на главной странице. При этом добавляется слушатель закрытия
closeModal() - отвечает за закрытие модального окна при нажатии на кнопку закрытия и нажатии на оверлей. Удаляет слушатель закрытия модального окна

## Класс "Api"
Базовая связь с сервером и получение от него данных

## Описание дополнительных классов

### Класс "ProductApi"
Наследует класс Api, отвечает за получение данных с сервера, необходимых нам. 
**Реализует метод**
getProducts() - отправляет запрос на сервер и получает массив объектов (товаров)

### Класс "Product"
Содержит в себе все данные о продукте, может их менять и использовать.
**Поля**:
id - уникальное значение для каждого товара. 
name - название товара.
icon - иконку-изображение товара. 
category - принадлежность к категории товаров.
about - описание товара.
cost - стоимость.
displayedСost - отображаемая стоимость. Тип string. На странице товары должны отображаться с указанием единицы оплаты, поэтому требуется дополнительное поле. В конструкторе будет рассчитываться по условию: если равно 0, значение "бесценно", если значение больше нуля, то значение + " синапсов". (В макете нет стоимости менее 5 синапсов, иначе можно было бы ввести третью проверку, от 1 до 4 значение было бы: значение + " синапса").
В **конструктор** при создании передаются данные от api

### Класс "Basket"
Хранит в себе данные для отрисовки их в корзине, нужные данные получает от экземпляров класса Product, которые вносят в корзину.

**Поля**
productsInBasket - по умолчанию при инициализации значение = [], при добавлении товаров - множество объектов класса BasketItem.
sumInBasket - по умолчанию при инициализации значение = 0, при добавлении товара добавляется (сложением) стоимость нового товара. Тип number
displayedSumInBasket - отображаемая стоимость. Тип string. В корзине общая стоимость должна отображаться с указанием единицы оплаты, поэтому требуется дополнительное поле.

**Методы**:
setToBasket() - принимает элемент класса Product, преобразует его в экземпляр вспопогательного класса BasketItemо, добавляет стоимость товара в sumInBasket, обновляет состояние поля displayedSumInBasket (если равно 0, значение "корзина пуста, положите что-нибудь сюда", если значение больше нуля, то значение + " синапсов". )
deleteFromBasket() - по нажатию кнопки удаления около товара - удаляет его, обновляет поля sumInBasket и displayedSumInBasket
cleanBasket() - очищает корзину, задаёт countIn значение 0

### Класс "BasketItem" 
Преобразует поля данных экземпляра Product для удобного использования в корзине

### Класс "Catalog"
Отвечает за отображение всех карточек на главной странице. Принимает экземляры всех объектов класса Product и отображает их на странице

**Основные методы**
renderCatalog() - используя экземпляр класса Prodact, отображает его на странице, добавляяв список элементов. Все элементы отображаются, потому что этот метод итерируется по всему списку элементов

### Класс "ModalCardFull"
Этот класс необходим для отображения попапа подробной карточки товара, принимает значение из объекта Product, на который был произведен клик (в момент клика создается конкретный экземпляр данного класса, относящийся к карточке товара, на который кликнули).

**Наследуется** от класса "Modal"

В **конструктор** приходит экземпляр класса Product, который переносит в этот класс значение своих полей соотвественно

**Основные методы** (кроме тех, что наследуются)
renderFullProductElement() - отвечает за отрисовку данных в модальном окне. При отрисовке проверка - если товар есть в корзине, для кнопки устанавливается неактивное состояние

### Класс "ModalOrder"
Отвечает за отрисовку последовательных попапов, которые появляются при оформлении заказа. Этот класс будет иметь всего 2 экземпляра - один будет реализовывать форму "способ оплаты" и "адрес доставки", второй - "e-mail" и "телефон" соответственно

Наследуется от класса Modal

**Основные методы**
operationSelectionButtons() обеспечивает корректную работу кнопок модального окна в выборе оплаты (онлайн/при получении)
formValidation() - следит за тем, чтобы кнопка для продолжения действий становилась активна только при заполенных формах. При необходимости метод может быть расширен подробной валидацией

### Класс "ModalBasket"
Отвечает за визуальное отображение модального окна корзины, принимает данные из класса Basket.
Наследуется от класса Modal

**Основные методы**
renderBasket() - создает все элементы в корзине
createBasketItemElement() создает элемент товара корзины (строку в модальном окне корзины)
updateBasketCounter() отслеживает число товаров в корзине для корректного отображения счетчика около иконки корзины

### Класс "ModalSuccess"
Класс отвечает за отрисовку данных в модальном окне успешного оформления заказа. Получает необходимые данные из поля displayedSumInBasket класса Basket.

Наследуется от класса Modal
Переопределяет поле "modalSelector" как "order-success"

**Поля**:
successIcon: тип string.
lastBuscetSum: тип string. В конструкторе превращает переданную последнюю сумму в корзины в строку "Списано ${сумма} синапсов"

**Основные методы**
renderModalSuccess() - открывает модальное окно, показывающее сообщение об успешном оформлении заказа, вносит данные в модальное окно для отрисовки. При закрытии это модальное окно вызывет cleanBasket() для корзины


